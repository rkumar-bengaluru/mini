{"version":3,"sources":["webpack://mini/webpack/universalModuleDefinition","webpack://mini/./src/app.js","webpack://mini/./src/mini/miniweb.js"],"names":["root","factory","exports","module","define","amd","this","current","totalNoOfPages","mini","linkClicked","e","preventDefault","target","textContent","performsearch","page","document","getElementById","innerHTML","query","value","length","mini_head","result","search","parseInt","noOfPage","rtime","total","time","response","results","forEach","r","title","substring","image","id","description","ratings","review","currentRating","parseFloat","toFixed","meta","noOfStars","Math","floor","halfstar","i","renderMeta","aggregateRating","ratingValue","reviewCount","p","pages","currentPage","range","totalPages","start","console","log","endIdx","lii","getElementsByTagName","addEventListener","renderPagination","init","event","key","message","lunr","indexFile","productMetaFile","MiNiWeb","idx","loadindex","allProducts","pageSize","Index","load","status","t1","round","Date","now","map","item","find","ref","startIndex","endIndex","sliced","slice","diff","stack"],"mappings":"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","file":"app.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"mini\"] = factory();\n\telse\n\t\troot[\"mini\"] = factory();\n})(this, function() {\nreturn ","import css from \"./css/style.css\";\r\nimport MiNiWeb from './mini/miniweb';\r\n\r\nlet current = 0;\r\nlet totalNoOfPages = 0;\r\nlet mini = new MiNiWeb();\r\nvar mini_head = '<div class=\\\"row\\\">';\r\nmini_head += '<div class=\\\"column\\\"><a href=\\'/mini\\'><img src=\\\"images/mini.svg\\\" alt=\\\"Mini\\\" class=\\\"mini_logo_small\\\"></a></div>';\r\nmini_head += '<div class=\\\"column\\\"><div class=\\\"search-btns\\\"><div class=\\\"mini-search-bar\\\"><input id=\\'mini-search-input\\' type=\\\"text\\\" autofocus>';\r\nmini_head += '<div class=\\\"mic_space\\\"> <img src=\\\"images/m-mic.png\\\" alt=\\\"Mic\\\" class=\\\"mic_icon\\\"> </div>';\r\nmini_head += '</div></div></div>';\r\nmini_head += '<div class=\\\"column\\\"><div class=\\\"mini-search-btns\\\"><div class=\\\"mini-btns-centered\\\">';\r\nmini_head += '<button id=\\\"mini-btn-search\\\" >Mini Search</button><br><span class=\\\"mini-error btns_centered\\\" id=\\'error\\'></span>';\r\nmini_head += ' </div></div></div>';\r\nmini_head += '</div>';\r\nmini_head += '<div id=\\'mini-results-response-time\\' class=\\'mini-results-response-time\\'></div>';\r\n\r\nfunction renderMeta(ratings, review) {\r\n    var currentRating = parseFloat((ratings)).toFixed(1);\r\n    var meta = '<div class=\\\"stars-wrapper stars mb-2\\\">';\r\n    meta += '<div>';\r\n    var noOfStars = Math.floor(currentRating);\r\n    var decimal = currentRating - noOfStars;\r\n    var halfstar = false;\r\n    if (decimal > 0)\r\n        halfstar = true;\r\n\r\n    meta += '<div class=\\\"stars-wrapper stars-main\\\">';\r\n    meta += '<div>';\r\n    //console.log('star image change - src=\\\"images/mini.svg\\\"');\r\n    for (var i = 0; i < noOfStars; i++) {\r\n        meta += '<img width=\\'16\\' height=\\'15\\' src=\\\"images/star.svg\\\" alt=\\'five star ratings\\' />';\r\n    }\r\n    if (halfstar) {\r\n        meta += '<img width=\\'16\\' height=\\'15\\' src=\\\"images/half-star.svg\\\" alt=\\'five star ratings\\' />';\r\n    }\r\n    meta += ' Ratings - ' + ratings + ' - ' + review + ' reviews';\r\n    meta += '</div>';\r\n    meta += '</div>';\r\n    meta += '</div>';\r\n    meta += '</div>';\r\n    return meta;\r\n}\r\n\r\nfunction linkClicked(e) {\r\n    e.preventDefault();\r\n    //console.log('current - ' + current + ', totalNoOfPages - ' + totalNoOfPages);\r\n    if (e.target.textContent === 'Previous') {\r\n        --current;\r\n        if (current > 0) {\r\n            performsearch(current);\r\n        }else {\r\n            ++current;\r\n        }\r\n    } else if (e.target.textContent === 'Next') {\r\n        ++current;\r\n        if (current < totalNoOfPages) {\r\n            performsearch(current);\r\n        } else {\r\n            --current;\r\n        }\r\n    } else {\r\n        performsearch(e.target.textContent);\r\n    }\r\n\r\n    //console.log(e.target.tagName);\r\n}\r\n\r\nfunction doPaging(current, total, r) {\r\n\r\n    let currentPage = current, // input\r\n        range = r,  // amount of links displayed \r\n        totalPages = total, // determined by amount of items, hardcoded for readability \r\n        start = 0;  // default\r\n\r\n    let paging = [];      // output variable\r\n\r\n    // Don't use negative values, force start at 1\r\n    if (currentPage < (range / 2) + 1) {\r\n        start = 1;\r\n\r\n        // Don't go beyond the last page \r\n    } else if (currentPage >= (totalPages - (range / 2))) {\r\n        start = Math.floor(totalPages - range + 1);\r\n\r\n    } else {\r\n        start = (currentPage - Math.floor(range / 2));\r\n    }\r\n\r\n    for (let i = start; i <= ((start + range) - 1); i++) {\r\n        if (i === currentPage) {\r\n            paging.push(`[${i}]`); // add brackets to indicate current page \r\n        } else {\r\n            paging.push(i.toString());\r\n        }\r\n    }\r\n    return paging;\r\n}\r\n\r\nfunction renderPagination(r, p) {\r\n    var pages = '';\r\n\r\n    if (r.noOfPage > 0) {\r\n        let currentPage = p, // input\r\n            range = 10,  // amount of links displayed \r\n            totalPages = r.total, // determined by amount of items, hardcoded for readability \r\n            start = 0;  // default\r\n\r\n\r\n        // Don't use negative values, force start at 1\r\n        if (currentPage < (range / 2) + 1) {\r\n            start = 0;\r\n\r\n            // Don't go beyond the last page \r\n        } else if (currentPage >= (totalPages - (range / 2))) {\r\n            start = Math.floor(totalPages - range + 1);\r\n\r\n        } else {\r\n            start = (currentPage - Math.floor(range / 2));\r\n        }\r\n        pages += '<nav aria-label=\\\"Page navigation pagination\\\">';\r\n        pages += '<ul class=\\\"pagination justify-content-center\\\">';\r\n        if ((p - 1) > 0) {\r\n            ///console.log('previous enabled...');\r\n            pages += '<li class=\\\"page-item\\\">';\r\n        } else {\r\n            console.log('previous diabled...');\r\n            pages += '<li class=\\\"page-item disabled\\\">';\r\n        }\r\n\r\n        pages += '<a class=\\\"page-link\\\" tabindex=\"-1\">Previous</a>';\r\n        pages += '</li>';\r\n\r\n        var endIdx = ((start + range) - 1);\r\n        if (endIdx > (r.noOfPage - 1)) {\r\n            endIdx = (r.noOfPage - 1);\r\n        }\r\n\r\n        for (let i = start; i <= endIdx; i++) {\r\n            if (i === currentPage) {\r\n                pages += '<li class=\\\"page-item active\\\"><a class=\\\"page-link\\\" >' + i + '</a></li>';\r\n            } else {\r\n                pages += '<li class=\\\"page-item\\\"><a class=\\\"page-link\\\" >' + i + '</a></li>';\r\n            }\r\n        }\r\n\r\n        ///\r\n        if(p === r.noOfPage) {\r\n            pages += '<li class=\\\"page-item disabled\\\">';\r\n        } else {\r\n            pages += '<li class=\\\"page-item\\\">';\r\n        }\r\n        \r\n        pages += '<a class=\\\"page-link\\\" >Next</a>';\r\n        pages += '</li>';\r\n        pages += '</ul>';\r\n        pages += '</nav>';\r\n    }\r\n    document.getElementById('pagination').innerHTML = pages;\r\n    var lii = document.getElementById('pagination').getElementsByTagName('li');\r\n    for (var i = 0; i < lii.length; i++) {\r\n        lii[i].addEventListener('click', (e) => {\r\n            linkClicked(e);\r\n        })\r\n    }\r\n}\r\n\r\nfunction performsearch(page) {\r\n    document.getElementById('error').innerHTML = '';\r\n    current = page;\r\n    var query = document.getElementById('mini-search-input').value;\r\n    //console.log('query =' + query);\r\n    if (query === '' || query.length === 0) {\r\n        document.getElementById('error').innerHTML = 'please enter a valid query'\r\n        return;\r\n    }\r\n    document.getElementById('mini-head').innerHTML = mini_head;\r\n\r\n    document.getElementById('mini-search-input').value = query;\r\n    //console.log('search query...' + query);\r\n    let result = mini.search(query, parseInt(page));\r\n    totalNoOfPages = result.noOfPage;\r\n    //console.log('response size...' + result.length);\r\n    var rtime = 'About ' + result.total + ' resuls in - ' + result.time + ' seconds...'\r\n    //console.log('rtime->' + rtime);\r\n    document.getElementById('mini-results-response-time').innerHTML = rtime;\r\n    var response = '';\r\n    result.results.forEach(function (r) {\r\n        if (typeof r !== 'undefined') {\r\n            var title = r.title.substring(0, 50) + '...';\r\n            response += '<div class=\\\"mini-result-row\\\"><div class=\\\"row\\\">';\r\n            response += '<div class=\\'column\\'><div class=\\\"mini-result-img\\\"><img heigth=\\'100px\\' width=\\'100px\\' src=' + r.image + ' alt=' + r.title + '/></div></div>';\r\n            response += '<div class=\\'column\\'>';\r\n            response += '<div class=\\\"mini-result-src\\\"><a target=\\'_blank\\'href=\\'' + r.id + '\\'>' + r.id + '</a></div>';\r\n            response += '<a target=\\'_blank\\'href=\\'' + r.id + '\\'>' + '<div class=\\\"mini-result-title\\\">' + title + '</div></a>';\r\n            if (r.description !== \"\") {\r\n                response += '<div class=\\\"mini-result-desc\\\">' + r.description.substring(0, 150) + '...' + '</div>';\r\n            } else {\r\n                response += '<div class=\\\"mini-result-desc\\\">' + r.description + '...' + '</div>';\r\n            }\r\n\r\n            response += '<div class=\\\"mini-result-meta\\\"> '\r\n            response += renderMeta(r.aggregateRating.ratingValue, r.aggregateRating.reviewCount);\r\n            response += '</div>';\r\n            response += '</div></div></div><br>';\r\n        }\r\n    });\r\n\r\n    renderPagination(result, parseInt(page));\r\n\r\n    if (result.total === 0) {\r\n        //console.log('no data' + result.total);\r\n        document.getElementById('mini-results').innerHTML = '<span class=\\\"mini-error\\\">Sorry no results matching your criteria...</span>';\r\n\r\n    } else {\r\n        //console.log('no of results ' + result.total);\r\n        document.getElementById('mini-results').innerHTML = response;\r\n    }\r\n    init();\r\n}\r\n\r\nfunction init() {\r\n    try {\r\n        //console.log(document.getElementById('mini-search-input'));\r\n        document.getElementById('mini-search-input').addEventListener('keyup', (event) => {\r\n            if (event.key === 'Enter') {\r\n                //console.log('enter clicked...');\r\n                event.preventDefault();\r\n                performsearch(0);\r\n                return;\r\n            }\r\n            document.getElementById('error').innerHTML = '';\r\n        })\r\n        document.getElementById('mini-btn-search').addEventListener('click', () => {\r\n            performsearch(0);\r\n        })\r\n    } catch (e) {\r\n        //console.log(e.stack);\r\n        document.getElementById('error').innerHTML = e.message;\r\n    }\r\n}\r\n\r\ninit();","\r\nconst lunr = require(\"lunr\");\r\nlet indexFile = require('../../vlocalshop/vlocalshop-index.json');\r\nlet productMetaFile = require('../../vlocalshop/vlocalshop.json');\r\n\r\nexport default class MiNiWeb {\r\n\r\n    constructor() {\r\n        this.idx = this.loadindex();\r\n        this.allProducts = productMetaFile;\r\n        this.pageSize = 12;\r\n        this.response = {\r\n            'noOfPage': 0,\r\n            'results': [],\r\n            'status': 'fail',\r\n            'time': '',\r\n            'total': 0\r\n        };\r\n        //console.log('loaded in browser');\r\n    }\r\n\r\n    loadindex() {\r\n        var idx = lunr.Index.load(indexFile);\r\n        return idx;\r\n    }\r\n\r\n    search(query, page) {\r\n        try {\r\n            this.response.results = [];\r\n            this.response.noOfPage = 0;\r\n            this.response.status = 'fail';\r\n            this.response.time = 0;\r\n            this.response.total = 0;\r\n            var t1 = Math.round(Date.now());\r\n            //console.log('query from mini -' + query);\r\n            var result = this.idx.search(query);\r\n            var response = result.map((item) => {\r\n                return this.allProducts.find((p) => item.ref === p.id)\r\n            })\r\n            var startIndex = page * this.pageSize;\r\n            var endIndex = page * this.pageSize + this.pageSize;\r\n            var sliced = response.slice(startIndex, endIndex);\r\n\r\n            var t2 = Math.round(Date.now());\r\n            var diff = ((t2 - t1) / 1000).toFixed(3);\r\n            //console.log('response length from mini -' + result.length + ',diff-' + diff);\r\n            this.response.results = sliced;\r\n            this.response.noOfPage = (result.length / this.pageSize).toFixed(0);\r\n            this.response.status = 'success';\r\n            this.response.time = diff;\r\n            this.response.total = result.length;\r\n            return this.response;\r\n        } catch (e) {\r\n            console.log(e.stack);\r\n            throw e;\r\n        }\r\n    }\r\n}"],"sourceRoot":""}